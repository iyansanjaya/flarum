(()=>{var t={n:s=>{var e=s&&s.__esModule?()=>s.default:()=>s;return t.d(e,{a:e}),e},d:(s,e)=>{for(var a in e)t.o(e,a)&&!t.o(s,a)&&Object.defineProperty(s,a,{enumerable:!0,get:e[a]})},o:(t,s)=>Object.prototype.hasOwnProperty.call(t,s)};(()=>{"use strict";const s=flarum.core.compat["admin/app"];var e=t.n(s);function a(t,s){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,s){return t.__proto__=s,t},a(t,s)}const n=flarum.core.compat["admin/components/ExtensionPage"];var i=t.n(n);const o=flarum.core.compat["common/utils/ItemList"];var r=t.n(o);const l=flarum.core.compat["common/components/Placeholder"];var d=t.n(l);const p=flarum.core.compat["common/components/Tooltip"];var f=t.n(p);const c=flarum.core.compat["common/utils/humanTime"];var g=t.n(c),h=function(t){function s(){for(var s,e=arguments.length,a=new Array(e),n=0;n<e;n++)a[n]=arguments[n];return(s=t.call.apply(t,[this].concat(a))||this).s3SetByEnv=void 0,s.settingPrefix=void 0,s.awsRegions=void 0,s}var n,i;i=t,(n=s).prototype=Object.create(i.prototype),n.prototype.constructor=n,a(n,i);var o=s.prototype;return o.oninit=function(s){t.prototype.oninit.call(this,s),this.awsRegions=e().data.FoFS3Regions,this.s3SetByEnv=e().data.s3SetByEnv,this.settingPrefix=e().data.FoFS3ShareWithFoFUpload?"fof-upload.":"fof-s3-assets."},o.content=function(){return m("div",{className:"S3SettingsPage"},m("div",{className:"container"},m("div",{className:"S3SettingsPageTabPage S3SettingsPage--settings"},m("div",{className:"Form"},this.settingsItems().toArray(),m("div",{className:"Form-group"},this.submitButton())))))},o.settingsItems=function(){var t=new(r());return t.add("general",m("div",{className:"Section"},m("h3",null,e().translator.trans("fof-s3-assets.admin.settings.general.heading")),m("p",{className:"helpText"},e().translator.trans("fof-s3-assets.admin.settings.general.help")),this.generalItems().toArray())),!this.s3SetByEnv&&t.add("s3",m("div",{className:"Section"},m("h3",null,e().translator.trans("fof-s3-assets.admin.settings.s3.heading")),m("p",{className:"helpText"},e().translator.trans("fof-s3-assets.admin.settings.s3.help")),this.s3Items().toArray())),!this.s3SetByEnv&&t.add("s3-compatible",m("div",{className:"Section"},m("h3",null,e().translator.trans("fof-s3-assets.admin.settings.s3-compatible.heading")),m("p",{className:"helpText"},e().translator.trans("fof-s3-assets.admin.settings.s3-compatible.help")),this.s3CompatibleItems().toArray())),t.add("revManifest",m("div",{className:"Section"},m("h3",null,e().translator.trans("fof-s3-assets.admin.settings.revision-manifest.heading")),m("p",{className:"helpText"},e().translator.trans("fof-s3-assets.admin.settings.revision-manifest.help")),this.revManifestItems().toArray())),t},o.generalItems=function(){var t=new(r());return e().initializers.has("fof-upload")&&!this.s3SetByEnv&&t.add("shareWithFoFUpload",this.buildSettingComponent({setting:"fof-s3-assets.share_s3_config_with_fof_upload",type:"boolean",label:e().translator.trans("fof-s3-assets.admin.settings.general.shareWithFoFUpload.label"),help:e().translator.trans("fof-s3-assets.admin.settings.general.shareWithFoFUpload.help")})),0===t.toArray().length&&this.s3SetByEnv&&t.add("setByEnv",m(d(),{text:e().translator.trans("fof-s3-assets.admin.settings.general.configured_by_environment")})),t},o.s3Items=function(){var t=new(r());return t.add("awsS3Key",this.buildSettingComponent({setting:this.settingPrefix+"awsS3Key",type:"string",label:e().translator.trans("fof-s3-assets.admin.settings.s3.keyid.label"),help:e().translator.trans("fof-s3-assets.admin.settings.s3.keyid.help")})),t.add("awsS3Secret",this.buildSettingComponent({setting:this.settingPrefix+"awsS3Secret",type:"password",label:e().translator.trans("fof-s3-assets.admin.settings.s3.secret.label"),help:e().translator.trans("fof-s3-assets.admin.settings.s3.secret.help")})),t.add("awsS3Region",this.buildSettingComponent({setting:this.settingPrefix+"awsS3Region",type:"string",label:e().translator.trans("fof-s3-assets.admin.settings.s3.region.label"),help:e().translator.trans("fof-s3-assets.admin.settings.s3.region.help")})),t.add("awsS3Bucket",this.buildSettingComponent({setting:this.settingPrefix+"awsS3Bucket",type:"string",label:e().translator.trans("fof-s3-assets.admin.settings.s3.bucket.label"),help:e().translator.trans("fof-s3-assets.admin.settings.s3.bucket.help")})),t.add("awsS3ACL",this.buildSettingComponent({setting:this.settingPrefix+"awsS3ACL",type:"string",label:e().translator.trans("fof-s3-assets.admin.settings.s3.acl.label"),help:e().translator.trans("fof-s3-assets.admin.settings.s3.acl.help")})),t.add("awsS3CacheControl",this.buildSettingComponent({setting:this.settingPrefix+"awsS3CacheControl",type:"number",min:0,label:e().translator.trans("fof-s3-assets.admin.settings.s3.cache-control.label"),help:e().translator.trans("fof-s3-assets.admin.settings.s3.cache-control.help")})),t},o.s3CompatibleItems=function(){var t=new(r());return t.add("cdnUrl",this.buildSettingComponent({setting:this.settingPrefix+"cdnUrl",type:"string",label:e().translator.trans("fof-s3-assets.admin.settings.s3-compatible.url.label"),help:e().translator.trans("fof-s3-assets.admin.settings.s3-compatible.url.help")})),t.add("awsS3Endpoint",this.buildSettingComponent({setting:this.settingPrefix+"awsS3Endpoint",type:"string",label:e().translator.trans("fof-s3-assets.admin.settings.s3-compatible.endpoint.label"),help:e().translator.trans("fof-s3-assets.admin.settings.s3-compatible.endpoint.help")})),t.add("awsS3UsePathStyleEndpoint",this.buildSettingComponent({setting:this.settingPrefix+"awsS3UsePathStyleEndpoint",type:"boolean",label:e().translator.trans("fof-s3-assets.admin.settings.s3-compatible.path-style-endpoint.label"),help:e().translator.trans("fof-s3-assets.admin.settings.s3-compatible.path-style-endpoint.help")})),t},o.revManifestItems=function(){var t,s=new(r()),a=this.setting("s3assets.revision"),n=this.setting("s3assets.revision_last_updated");try{t=JSON.parse(a())}catch(s){console.error("Error parsing JSON:",s),t={error:"Invalid JSON format"}}var i=n();return s.add("revManifest-timestamp",m("div",null,e().translator.trans("fof-s3-assets.admin.settings.revision-manifest.timestamp"),m("p",{className:"helpText"},m(f(),{text:i},m("span",null,g()(n())))))),s.add("revManifest-data",m("div",null,m("pre",null,JSON.stringify(t,null,2)))),s},s}(i());const u=flarum.core.compat["common/extend"],b=flarum.core.compat["admin/components/StatusWidget"];var S=t.n(b);e().initializers.add("fof/s3-assets",(function(){e().extensionData.for("fof-s3-assets").registerPage(h),(0,u.extend)(S().prototype,"items",(function(t){t.add("cdn",[m("strong",null,"CDN"),m("br",null),e().data.cdn],50)}))}))})(),module.exports={}})();
//# sourceMappingURL=admin.js.map